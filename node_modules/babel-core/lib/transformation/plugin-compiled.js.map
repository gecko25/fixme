{"version":3,"sources":["plugin.js"],"names":[],"mappings":"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","file":"plugin-compiled.js","sourcesContent":["/* eslint max-len: 0 */\n\n\"use strict\";\n\nvar _inherits = require(\"babel-runtime/helpers/inherits\")[\"default\"];\n\nvar _classCallCheck = require(\"babel-runtime/helpers/class-call-check\")[\"default\"];\n\nvar _getIterator = require(\"babel-runtime/core-js/get-iterator\")[\"default\"];\n\nvar _interopRequireDefault = require(\"babel-runtime/helpers/interop-require-default\")[\"default\"];\n\nvar _interopRequireWildcard = require(\"babel-runtime/helpers/interop-require-wildcard\")[\"default\"];\n\nexports.__esModule = true;\n\nvar _fileOptionsOptionManager = require(\"./file/options/option-manager\");\n\nvar _fileOptionsOptionManager2 = _interopRequireDefault(_fileOptionsOptionManager);\n\nvar _babelMessages = require(\"babel-messages\");\n\nvar messages = _interopRequireWildcard(_babelMessages);\n\nvar _store = require(\"../store\");\n\nvar _store2 = _interopRequireDefault(_store);\n\nvar _babelTraverse = require(\"babel-traverse\");\n\nvar _babelTraverse2 = _interopRequireDefault(_babelTraverse);\n\nvar _lodashObjectAssign = require(\"lodash/object/assign\");\n\nvar _lodashObjectAssign2 = _interopRequireDefault(_lodashObjectAssign);\n\nvar _lodashLangClone = require(\"lodash/lang/clone\");\n\nvar _lodashLangClone2 = _interopRequireDefault(_lodashLangClone);\n\nvar GLOBAL_VISITOR_PROPS = [\"enter\", \"exit\"];\n\nvar Plugin = (function (_Store) {\n  _inherits(Plugin, _Store);\n\n  function Plugin(plugin, key) {\n    _classCallCheck(this, Plugin);\n\n    _Store.call(this);\n\n    this.initialized = false;\n    this.raw = _lodashObjectAssign2[\"default\"]({}, plugin);\n    this.key = key;\n\n    this.manipulateOptions = this.take(\"manipulateOptions\");\n    this.post = this.take(\"post\");\n    this.pre = this.take(\"pre\");\n    this.visitor = this.normaliseVisitor(_lodashLangClone2[\"default\"](this.take(\"visitor\")) || {});\n  }\n\n  Plugin.prototype.take = function take(key) {\n    var val = this.raw[key];\n    delete this.raw[key];\n    return val;\n  };\n\n  Plugin.prototype.chain = function chain(target, key) {\n    if (!target[key]) return this[key];\n    if (!this[key]) return target[key];\n\n    var fns = [target[key], this[key]];\n\n    return function () {\n      var val = undefined;\n\n      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      for (var _i = 0; _i < fns.length; _i++) {\n        var fn = fns[_i];\n        if (fn) {\n          var ret = fn.apply(this, args);\n          if (ret != null) val = ret;\n        }\n      }\n      return val;\n    };\n  };\n\n  Plugin.prototype.maybeInherit = function maybeInherit(loc) {\n    var inherits = this.take(\"inherits\");\n    if (!inherits) return;\n\n    inherits = _fileOptionsOptionManager2[\"default\"].normalisePlugin(inherits, loc, \"inherits\");\n\n    this.manipulateOptions = this.chain(inherits, \"manipulateOptions\");\n    this.post = this.chain(inherits, \"post\");\n    this.pre = this.chain(inherits, \"pre\");\n    this.visitor = _babelTraverse2[\"default\"].visitors.merge([inherits.visitor, this.visitor]);\n  };\n\n  /**\n   * We lazy initialise parts of a plugin that rely on contextual information such as\n   * position on disk and how it was specified.\n   */\n\n  Plugin.prototype.init = function init(loc, i) {\n    if (this.initialized) return;\n    this.initialized = true;\n\n    this.maybeInherit(loc);\n\n    for (var key in this.raw) {\n      throw new Error(messages.get(\"pluginInvalidProperty\", loc, i, key));\n    }\n  };\n\n  Plugin.prototype.normaliseVisitor = function normaliseVisitor(visitor) {\n    for (var _iterator = GLOBAL_VISITOR_PROPS, _isArray = Array.isArray(_iterator), _i2 = 0, _iterator = _isArray ? _iterator : _getIterator(_iterator);;) {\n      var _ref;\n\n      if (_isArray) {\n        if (_i2 >= _iterator.length) break;\n        _ref = _iterator[_i2++];\n      } else {\n        _i2 = _iterator.next();\n        if (_i2.done) break;\n        _ref = _i2.value;\n      }\n\n      var key = _ref;\n\n      if (visitor[key]) {\n        throw new Error(\"Plugins aren't allowed to specify catch-all enter/exit handlers. Please target individual nodes.\");\n      }\n    }\n\n    _babelTraverse2[\"default\"].explode(visitor);\n    return visitor;\n  };\n\n  return Plugin;\n})(_store2[\"default\"]);\n\nexports[\"default\"] = Plugin;\nmodule.exports = exports[\"default\"];"]}