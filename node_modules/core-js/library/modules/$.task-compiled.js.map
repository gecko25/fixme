{"version":3,"sources":["$.task.js"],"names":[],"mappings":"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","file":"$.task-compiled.js","sourcesContent":["var ctx                = require('./$.ctx')\n  , invoke             = require('./$.invoke')\n  , html               = require('./$.html')\n  , cel                = require('./$.dom-create')\n  , global             = require('./$.global')\n  , process            = global.process\n  , setTask            = global.setImmediate\n  , clearTask          = global.clearImmediate\n  , MessageChannel     = global.MessageChannel\n  , counter            = 0\n  , queue              = {}\n  , ONREADYSTATECHANGE = 'onreadystatechange'\n  , defer, channel, port;\nvar run = function(){\n  var id = +this;\n  if(queue.hasOwnProperty(id)){\n    var fn = queue[id];\n    delete queue[id];\n    fn();\n  }\n};\nvar listner = function(event){\n  run.call(event.data);\n};\n// Node.js 0.9+ & IE10+ has setImmediate, otherwise:\nif(!setTask || !clearTask){\n  setTask = function setImmediate(fn){\n    var args = [], i = 1;\n    while(arguments.length > i)args.push(arguments[i++]);\n    queue[++counter] = function(){\n      invoke(typeof fn == 'function' ? fn : Function(fn), args);\n    };\n    defer(counter);\n    return counter;\n  };\n  clearTask = function clearImmediate(id){\n    delete queue[id];\n  };\n  // Node.js 0.8-\n  if(require('./$.cof')(process) == 'process'){\n    defer = function(id){\n      process.nextTick(ctx(run, id, 1));\n    };\n  // Browsers with MessageChannel, includes WebWorkers\n  } else if(MessageChannel){\n    channel = new MessageChannel;\n    port    = channel.port2;\n    channel.port1.onmessage = listner;\n    defer = ctx(port.postMessage, port, 1);\n  // Browsers with postMessage, skip WebWorkers\n  // IE8 has postMessage, but it's sync & typeof its postMessage is 'object'\n  } else if(global.addEventListener && typeof postMessage == 'function' && !global.importScripts){\n    defer = function(id){\n      global.postMessage(id + '', '*');\n    };\n    global.addEventListener('message', listner, false);\n  // IE8-\n  } else if(ONREADYSTATECHANGE in cel('script')){\n    defer = function(id){\n      html.appendChild(cel('script'))[ONREADYSTATECHANGE] = function(){\n        html.removeChild(this);\n        run.call(id);\n      };\n    };\n  // Rest old browsers\n  } else {\n    defer = function(id){\n      setTimeout(ctx(run, id, 1), 0);\n    };\n  }\n}\nmodule.exports = {\n  set:   setTask,\n  clear: clearTask\n};"]}